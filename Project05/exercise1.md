# Типы web-приложений

## **Многостраничные приложения**
MPA или Multi Page Application — это многостраничные приложения, которые работают по традиционной схеме. Это означает, что при каждом незначительном изменении данных или загрузке новой информации страница обновляется. Такие приложения тяжелее, чем одностраничные, поэтому их использование целесообразно только в тех случаях, когда нужно отобразить большое количество контента.

Примеры: Сбермаркет https://sbermarket.ru/, Сбермегамаркет https://sbermegamarket.ru/, Яндекс Маркет https://market.yandex.ru/.
## Преимущества
- Простая SEO оптимизация — можно оптимизировать каждую из страниц приложения под нужные ключевые запросы;
- Привычность для пользователей — за счет простого интерфейса и классической навигации.
## Недостатки
- Тесная связь между бекендом и фронтендом, поэтому их не получается развивать параллельно;
- сложная разработка — требуют использования фреймворков как на стороне клиента, так и на стороне сервера, что увеличивает сроки и бюджет разработки.

## **Одностраничные приложения**
SPA или Single Page Application — это одностраничное веб-приложение, которое загружается на одну HTML-страницу. Благодаря динамическому обновлению с помощью JavaScript, во время использования не нужно перезагружать или подгружать дополнительные страницы. На практике это означает, что пользователь видит в браузере весь основной контент, а при прокрутке или переходах на другие страницы, вместо полной перезагрузки нужные элементы просто подгружаются.

В процессе работы пользователю может показаться, что он запустил не веб-сайт, а десктопное приложение, так как оно мгновенно реагирует на все его действия, без задержек и «подвисаний».
Такого эффекта удается добиться с помощью продвинутых фреймворков JavaScript: Angular, React, Ember, Meteor, Knockout.

Примеры: Gmail https://mail.google.com/, ВКонтакте http://vk.com/, Meduza https://meduzanews.ru/.
## Преимущества
- Высокая скорость — все ресурсы загружаются за одну сессию, а во время действий на странице данные просто меняются, что очень экономит время;
- гибкость и отзывчивость пользовательского интерфейса — за счет того, что веб-страница всего одна, проще построить насыщенный интерфейс, хранить сведения о сеансе, управлять состояниями представлений и анимацией;
- упрощенная разработка — код можно начинать писать с файла file://URL, не используя сервер, не нужен отдельный код для рендера страницы на стороне сервера;
- кэширование данных — приложение отправляет всего один запрос, собирает данные, а после этого может функционировать в offline-режиме.
## Недостатки
- Seo оптимизация требует решений в виде серверного рендеринга — из-за того, что контент загружается при помощи технологии AJAX, которая подразумевает динамическое изменение содержания станицы, а для оптимизации важна устойчивость;
- нагрузка на браузер — из-за того, что клиентские фреймворки тяжелые, они довольно долго загружаются;
- необходима поддержка JavaScript — без JS нельзя полноценно пользоваться полным функционалом приложения;
- утечка памяти в Java Script — из-за плохой защиты, SPA больше подвержена действиям злоумышленников и утечке памяти.

## **PWA приложения**
Progressive Web Application (PWA, прогрессивные web-приложения) – новый способ «подачи» web-сервисов, который максимально сближает их с обычным, привычным десктопным приложением, но на качественно более высоком уровне.
Представим ситуацию: человек посещает некоторый сайт, который предлагает ему установить его на другие устройства. Теперь и на ПК, и в телефоне вы сможете получать уведомления, работать офлайн, независимо от модели устройств и их мощностей.

Главная область применения таких приложений – мобильные устройства. Пользователю больше не нужно входить на AppStore или PlayMarket, чтобы скачать программу – все сделает браузер автоматически (а еще создаст ярлык на рабочем столе, позволит работать с собой без доступа к сети и т.д.). Фактически, мы получаем аналог обычного приложения с тем же функционалом и множеством плюсов (для PWA не требуется лишняя память смартфона, ради которой приходится удалять фото и видео, они весят менее 1 Мб).

При появлении нового контента PWA отправляет пользователю push-уведомление. Следует признать, что в скором времени эти приложения смогут заменить практически все мобильные аналоги. Хоть технология и появилась в 2007 году в компании Apple, изначально она «не зашла» в силу слабой «прогретости» публики, зато ко второй половине 2016 года Google развил ее и сделал популярной.

PWA-версии приложений встречаются у многих компаний (тот же Aliexpress почти в 2 раза повысил конверсию от новых посетителей благодаря этому).

Примеры: Google Docs https://docs.google.com/, Aliexpress https://aliexpress.ru/, Walmart https://www.walmart.com/.
## Преимущества
- Кроссплатформенность — могут работать сразу с несколькими операционными системами;
- высокая скорость работы и возможность запуска и отображения данных в офлайн-режиме с моментальной загрузкой;
- высокая скорость установки;
- быстрая разработка — для создания PWA, не нужен отдельный сайт, достаточно изменить уже существующий.
## Недостатки
- Не все браузеры поддерживают основные функции таких приложений.

## **Перечислим основные преимущества и недостатки SPA, MPA и PWA приложений:**
| Приложение | Преимущества | Недостатки |
| ------ | ------ | ------ |
| SPA | Высокая скорость работы, кеширование данных, быстрая разработка | Нагрузка на браузер, возможны утечки памяти и уязвимости в безопасности  |
| MPA | Привычны посетителям, легкая seo-оптимизация | Сложная разработка и поддержка, существенные финансовые вливания |
| PWA | Быстрая разработка, высокая скорость загрузки, офлайн-работа | Поддерживается не всеми браузерами и платформами |

## **Зачем нужны PWA**
Прогрессивные приложения или Progressive Web Application взаимодействуют с пользователем, как приложение. Они могут устанавливаться на главный экран смартфона, отправлять push-уведомления и работать в офлайн-режиме.

## **Какому приложению отдать предпочтение при разработке**

На каких приложениях остановаться, зависит от цели проекта и наличия ресурсов на разработку и продвижение.
- Если вы строите информационные веб проект, то достаточно адаптивный вебсайт, который подстраивает верстку под размер экрана.
- Если вам нужно добавить раздел, не требующий индексации в поисковиках для многостраничного ресурса (например, личные кабинеты админов и пользователей), то лучше сделать его в формате SPA.
- Если вам нужно обеспечить функциональность близкую к полноценным программам и охватить как мобильных, так и ПК пользователей за минимальный бюджет, то нужно делать PWA.
- Если ваше приложение будет использовать продвинутые функции системного железа (NFC, камеру, сканер отпечатков пальца, ресурсы видеокарты), например вы делаете 3D-игру, то лучше делать нативное приложение для каждой платформы.

## **Технологии PWA**

***Service Worker***

Сердце PWA — Service Worker. Это проксирующий слой между фронтэндом и бэкэндом, находящийся в браузере. Все запросы браузера идут через него. Данное разделение на два независимых слоя позволило сделать переход обычного веб сайта в PWA максимально простым.

Из хранилищ у Service Worker'a есть доступ к Cache Storage для web ресурсов, и IndexDB для данных. Но, самое главное, полная свобода для реализации бизнес логики.

Можно, например, принять запрос от браузера, проверить состояние сети, взять данные из хранилища, произвести с ними операции и вернуть некий результат обратно в браузер — который будет думать, что ответ ему пришел от сервера. Или не будет — как разработчик захочет, так и сделает. Два браузерных слоя (клиентский фронтэнд и Service Worker) позволяют писать полноценные приложения.

В тоже время, для большинства сайтов будет достаточно кэширующей функциональности Service Worker'a, чтобы превратиться в PWA.

PWA не зависит ни от каких-то фреймворков, это чистый javascript, хотя даже специалисты Google на Хабре зачем-то советуют использовать библиотечные генераторы кода. Service Worker прекрасно пишется руками, и это нужно, чтобы хорошо понимать и контролировать логику работы твоего приложения.

С программистской точки зрения Service Worker представляет собой javascript файл, подключаемый в html коде страницы. В нем разработчик определяет логику работы с приходящими из фронтэнда запросами и другую функциональность.

***HTTPS***

PWA требует, чтобы все ресурсы сайта передавались по HTTPS протоколу. SSL сертификат можно получить бесплатно, некоторые хостеры это делают за вас. Но критично, чтобы на сайте не было ссылок на незащищенные ресурсы — некоторые браузеры просто не будут отображать сайт в этом случае.

Основная встречаемая в таких случаях проблема — картинки. Часто редакторы или комментаторы ставят в материал ссылки на картинки из интернета, иногда они автоматически туда (в материал) попадают. Необходимо картинки пересохранять или к себе, или на сервис с доступом по HTTPS.

***Application Shell***

App shell — это просто скелет графического интерфейса, шаблон. Для примера, возьмем средний сайт c хидером, двумя колонками и прочим. Грубо говоря, вырежем из него контент текущей страницы и всю динамическую информацию, оставшаяся статика — app shell.

Суть в том, что app shell хранится на клиенте и загружается при запуске приложения, а затем уже в него грузится из сети динамическая информация. И пока она грузится, app shell должен выглядеть красиво («лоадеры» на местах и т.п.)

Данную архитектуру сайта — загрузку контента и иной динамичной информации через ajax вызовы — можно продумать и реализовать на сайте заранее, тогда переход в PWA будет совсем несложным.

App shell — это как оболочка нативной программы. Смотрите на свое PWA как на нативную программу, и многое станет проще.

***Web App manifest***

JSON файл, декларативно определяющий для браузера название приложения, иконку, как будет выглядеть PWA (fullscreen, standalone и др.) и некоторые другие параметры. Позволяет «установить» PWA как отдельное приложение на домашний экран смартфона.

***Push Notifications***

Если посерфить интернет с Chrome DevTools, открытым на вкладке Application, то можно увидеть, как мало сайтов пользуют PWA технологии. А 90% тех, что пользуют, делают это только ради Push Notifications.

## **Что делает приложение прогрессивным веб-приложением?**

PWA или Прогрессивное приложение близко по своим возможностям, функциям и качеству пользовательского опыта к нативным компьютерным и мобильным приложениям.

Четкой границы между не-PWA и PWA приложением нет. Но можно выделить ряд характеристик.

- Прогрессивность: ваше веб-приложение должно работать для каждого пользователя, независимо от выбора браузера.

- В частности PWA должно содержать прокси-слой (Service Worker) и Web App манифест.

- Интерактивные функции: push-уведомления и гео-локация.

- Независимость от подключения: Да, именно это является одним из невоспетых героев PWA. Ваше веб-приложение должно работать независимо от интернет-соединения или некоторые функции должны работать в условиях отсутствия или медленной сети.

- Схожесть с приложением: Оно должно предоставлять пользователям опыт, подобный приложению. К таким возможностям относятся полноэкранный режим, доступ к различным встроенным аксессуарам, таким как камера, микрофон и т.д.

- Актуальность: Ваше веб-приложение всегда должно быть актуальным и не должно беспокоить пользователя просьбами об обновлении.

- Безопасность: Оно должно обслуживаться по протоколу HTTPS.

- Легкодоступность: Вы можете установить приложение или, скажем, получить доступ к нему прямо с домашнего экрана одним нажатием на кнопку «Добавить на домашний экран».

## **Тестирование SPA (Single-Page Application) и MPA (Multi-Page Application) имеет несколько различий и особенностей.**

- Объем и сложность тестирования: SPA обычно имеют меньшее число страниц, поэтому объем тестирования ниже, чем у MPA. Однако, SPA обладают большей сложностью в отношении динамически загружаемых данных и асинхронных операций.

- Нагрузка на сервер: MPA зачастую провоцирует большую нагрузку на сервер, поскольку каждое действие пользователя имеет свое собственное HTTP-запрос. Из-за этого, тестирование MPA должно включать тестирование сервера и настройки конфигурации.

- Приложение на стороне клиента: SPA относятся к типу тонких клиентов, поэтому тестирование должно включать проверку браузера клиента, выполнение JavaScript и настройку клиентского приложения. Другими словами, тестирование SPA должно охватывать и клиентскую и серверную часть.

- Сценарии использования: тестирование SPA и MPA должно охватывать разные сценарии использования. Например, тестирование SPA должно проверить, как приложение работает в разных браузерах, как приложение адаптируется к разным экранам и устройствам, а также как работают push-уведомления и роутинг. С другой стороны, тестирование MPA должно проверить, как работает приложение при навигации между страницами, работу форм и функций поиска на каждой странице.

- Тестирование MPA и SPA имеет сходства по управлению данными, открытости, производительности и безопасности. Однако, из-за различий в структуре и для успешного тестирования надо подходить к каждому типу приложения индивидуально.

## **Итак, что же нужно тестировать в прогрессивном веб-приложении?**

При тестировании прогрессивного веб-приложения необходимо проверить следующие моменты:

- Сайт обслуживается по HTTPS: Безопасность является одной из основных проблем в прогрессивном веб-приложении, поэтому вам необходимо убедиться, что ваше веб-приложение обслуживается по HTTPS.
Как проверить? Вы можете использовать Lighthouse от Google Developers, jitbit, seositecheckup, digicert, ssl shopper, ssl labs и т.д., чтобы проверить, обслуживается ли ваш сайт по HTTPS или нет.

- Веб-страницы отзывчивы: Убедитесь, что ваше веб-приложение демонстрирует отзывчивое поведение на всех мобильных и настольных устройствах.
Как проверить? Вы можете использовать функцию отзывчивости LambdaTest для проверки отзывчивости вашего веб-приложения.

- Автономная загрузка: Все ваши веб-страницы или хотя бы некоторые из них должны работать, даже когда ваше приложение находится в автономном режиме. Вам необходимо убедиться, что ваше веб-приложение отвечает сообщением 200, когда оно находится в автономном режиме.
Как проверить? Опять же, поскольку Google активно продвигает экосистему PWA, у них есть одни из лучших инструментов для тестирования PWA-приложений. Например, Lighthouse. Альтернативой является Wiremock.

- Кросс-браузерная совместимость: Вам необходимо протестировать ваше веб-приложение на кросс-браузерную совместимость, чтобы убедиться, что ваше веб-приложение обеспечивает удобство работы во всех браузерах.
Как протестировать? Вы можете использовать LambdaTest для тестирования кросс-браузерной совместимости.

- Переходы между страницами должны быть плавными и не должны вызывать ощущения, что они блокируют сеть: Переходы являются ключевым фактором для восприятия производительности, поэтому они не должны быть плавными при перемещении, даже при медленном интернет-соединении.
Как проверить? Это следует делать вручную в медленной сети. Когда вы нажимаете на любую кнопку или ссылку, она должна немедленно реагировать либо немедленным переходом на экран гнезда и в ожидании показывать экран загрузки, либо индикатором загрузки, пока приложение не дождется ответа.