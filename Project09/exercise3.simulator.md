# Возможности "Your Virtual Device" в Anroid Studio

## AVD (Android Virtual Device)

AVD — это конфигурация, которая определяет характеристики устройства, который нужно эмулировать: форм-фактор, версию Android и различные характеристики. Он содержит следующие компоненты:

### Профиль устройства

Профиль устройства определяет характеристики устройства, которое нужно эмулировать. Менеджер AVD содержит в себе несколько предустановленных профилей (такие устройства, как Nexus и Pixel), но также позволяет создавать свои собственные. Кроме того, некоторые профили включают Google Play, такие профили полностью совместимы с CTS и позволяют использовать образы системы с установленным приложением Google Play.

### Образ системы

Содержит нужную версию Android. Для полноты тестирования лучше всего создавать AVD для каждой версии Android, которую поддерживает приложение. Некоторые образы системы помечены надписью Google APIs: это означает, что они включают в себя доступ к сервисам Google Play. Если же образы помечены как Google Play, то кроме сервисов Google Play они включают также само приложение Google Play.

### Область хранения

AVD имеет специальную область хранения на компьютере. В ней хранятся пользовательские данные, данные устройства, такие как установленные приложения и настройки, а также эмулированная SD-карта. Если есть такая необходимость, с помошью Менеджера AVD можно удалять с эмулятора пользовательские данные, приводя ему к «заводскому» виду.

### Скин

Скин нужен для того, чтобы задать устройству внешний вид. Менеджер AVD содержит несколько предустановленных скинов, также имеется возможность использовать сторонние скины.

## Создание Virtual Device

Для того, чтобы создать новый AVD, нужно запустить **AVD Manager**. Для этого нужно в Android Studio в меню выбрать **Tools — AVD Manager**. Откроется окно менеджера, в котором будет отображаться список созданных эмуляторов.

Чтобы создать новый эмулятор, нужно нажать на **Create Virtual Device** в Менеджере AVD. Откроется окно, в котором будет предложено выбрать тип устройства и профиль.

После того, как будет выбран профиль, нужно нажать на Next для перехода далее. Здесь нужно выбрать, какой образ системы использовать.

На вкладке **Recommended** перечислены рекомендуемые образы системы. Другие вкладки содержат более полный список доступных образов. Справа приводится информация о выбранном образе (уровень API, версия).

Если образ ранее не был скачан, рядом с названием появится кнопка "Download", нажатие на которую начнёт процесс скачивания. Для скачивания образа потребуется доступ к Интернету.

Чтобы перейти на следующий этап, нужно нажать "Next". В новом окне будет предложено изменить дополнительные свойства AVD (название AVD, ориентацию экрана).

После нажатия на **Show Advanced Settings** откроются дополнительные настройки, в которых можно изменить следующее:

- Фронтальную/основную камеру.
- Вместо эмуляции изображения есть возможность использовать в качестве камеру подключённую вебкамеру.
- Скорость и качество интернет-соединения.
- Способ загрузки. Если выбрать Quick Boot, то эмулятор будет сохранять текущее состояние при выключении и загружать его при включении.
- Cold Boot — холодный старт.
- Количество выделенной оперативной памяти и места на диске.
- Включение\отключение внешнего вида эмулятора.
- Включение\отключение ввода с клавиатуры.

После того, как AVD будет настроен, останется только нажать "Finish". После этого созданный AVD можно будет увидеть в окне Менеджера AVD.

Если нужно будет изменить настройки AVD, это легко можно сделать, нажав на кнопку "Edit" рядом с нужным эмулятором в списке Менеджера AVD.

Чтобы запустить эмулятор, достаточно в Менеджере AVD нажать на кнопку "Run".

Протестировать приложение на эмуляторе можно, нажав на кнопку "Run" в Android Studio.

Откроется окно **Select Deployment Target**, в котором будет предложено выбрать, на каком устройстве нужно запустить приложение.

После нажатия "OK" начнётся запуск выбранного эмулятора, если он не до сих пор запущён, либо установка APK на эмулятор.

Примечание: также установить приложение на эмулятор можно, просто перетащить APK-файл на экран эмулятора.

Эмулятор Android позволяет тестировать самые разные функции. Их можно настроить, нажав на кнопку **Extended Controls** в меню рядом с эмулятором.

Откроется окно с настройками, разбитыми на различные категории. Здесь можно настроить отправку данных, различные свойства устройства и так далее. Рассмотрим некоторые из категорий.

Вкладка **Location** позволяет симулировать изменение местоположения устройства. В этом окне можно задавать широту, долготу и высоту и отслеживать изменение координат.

Вкладка **Cellular** содержит параметры, регулирующие качество связи и мобильного интернета. Например, можно настроить тип сети, выбрав LTE, GPRS или другие варианты, силу сигнала и домашний регион/роуминг.

На вкладке **Battery** можно установить уровень заряда батареи и её состояние (заряжается, разряжается и так далее).

Вкладка **Phone** позволяет симулировать входящие звонки и смс-сообщения.

Для того, чтобы отправить входящий вызов, достаточно нажать на кнопку "Call device", после чего на эмуляторе появится соответствующее уведомление. При желании можно также задать свой номер телефона.

Аналогичным образом можно отправить текстовое сообщение, введя текст сообщения в поле "SMS Message" и нажав "Send Message".

Вкладка **Directional** pad представляет собой дополнительный набор элементов управления, встроенных в устройство или подключенных внешне, который обеспечивает управление направлением (вверх, вниз, вправо, влево).

На вкладке **Fingerprnt** можно симулировать использование датчика отпечатков. На выбор предлагается несколько предустановленных отпечатков пальцев для различных тестов. Чтобы сообщить датчику о том, что пользователь прикладывает палец, нужно нажать на кнопку "Touch the sensor".

Вкладка **Virtual** sensors отвечает за симуляцию работы различных датчиков, таких как гироскоп, акселерометр и магнитометр.

С их помощью можно тестировать приложение на предмет изменения положения устройства в пространстве, ориентации или того и другого. Эмулятор имитирует способ реагирования датчиков акселерометра и магнитометра при перемещении или повороте реального устройства.

Кроме того, на вкладке **Additional sensors** находятся различные датчики положения и окружения. На этой вкладке можно настроить следующее:

### Температура окружающей среды

Имитирует температуру воздуха.

### Магнитное поле

Имитирует изменение окружающего магнитного поля, значения указываются в микротеслах (мкТ).

### Близость

Определяет расстояние до какого-либо объекта.

### Свет

Имитирует изменение уровня освещённости, измеряется в люксах.

### Давление

Измеряет давление окружающего воздуха, значения указаны в миллибар.

### Относительная влажность

Изменяет собственно относительную влажность окружающей среды.

*Что касается остальных пунктов меню эмулятора, то они вкратце перечислены ниже.*

- Кнопка включания/выключения экрана. При удерживании включает/выключает устройство.
- Кнопка увеличения громкости
- Кнопка уменьшения громкости
- Поворот экрана  налево
- Поворот экрана направо
- Создание скриншота экрана. По умолчанию, скриншот сохраняется на рабочий стол и имеет название Screenshot_yyyymmdd-hhmmss.png.
- Изменяет курсор на лупу. Клик левой кнопкой мыши по экрану увеличивает масштаб на 25%, правой кнопкой мыши — уменьшает. Для возврата из режима нужно повторнго нажать на кнопку.
- Возвращает к предыдущему экрану либо закрывает диалоговое окно, меню опций, панель уведомлений или экранную клавиатуру.
- Возвращает на домашний экран.
- Открывает список недавних приложений.